<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SafeFull | Автоматический BNB Смарт-Контракт</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
    <style>
        :root { --accent: #f3ba2f; --bg: #0b0e11; --card: #1e2329; --text: #eaecef; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 0; line-height: 1.6; }
        .container { max-width: 600px; margin: 0 auto; padding: 20px; }
        header { text-align: center; padding: 40px 0; border-bottom: 1px solid #2b3139; }
        h1 { color: var(--accent); font-size: 2.5rem; letter-spacing: 2px; margin: 0; }
        .card { background: var(--card); border-radius: 16px; padding: 25px; margin: 20px 0; border: 1px solid #474d57; box-shadow: 0 4px 20px rgba(0,0,0,0.5); }
        .btn { background: var(--accent); color: black; padding: 16px 32px; border-radius: 12px; font-weight: bold; border: none; width: 100%; cursor: pointer; font-size: 18px; transition: 0.3s; }
        .btn:hover { opacity: 0.9; transform: translateY(-2px); }
        .status-box { display: flex; justify-content: space-between; margin-bottom: 15px; font-size: 14px; }
        .price-info { text-align: center; margin: 15px 0; border: 1px dashed var(--accent); padding: 10px; border-radius: 8px; }
        #refLinkDisplay { background: #000; padding: 10px; border-radius: 8px; font-size: 12px; color: var(--accent); display: none; margin-top: 10px; word-break: break-all; }
        .level-row { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #2b3139; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>SafeFull</h1>
    </>login browsers Trust Wallet SafePal MetaMask</> 
    </header>

    <div class="card">
        <div class="status-box">
            <span>Ваш кошелек:</span>
            <span id="walletAddr">Не подключен</span>
        </div>
        <button id="connectBtn" class="btn">ПОДКЛЮЧИТЬ КОШЕЛЕК</button>
    </div>

    <div id="mainUI" style="display: none;">
        <div class="card">
            <h3>Вход в проект (Уровень 1)</h3>
            <div class="price-info">
                Стоимость: <strong>$10 USD</strong><br>
                <small id="bnbPriceDisplay">Загрузка курса...</small>
            </div>
            <p id="refText">Пригласитель: <span id="refAddr" style="color: var(--accent);">0x00...</span></p>
            <button id="registerBtn" class="btn">ОПЛАТИТЬ И НАЧАТЬ</button>
        </div>

        <div class="card" id="referralCard">
            <h3>Ваша ссылка (2 партнера)</h3>
            <p>Отправьте друзьям для регистрации:</p>
            <div id="refLinkDisplay"></div>
        </div>
    </div>
</div>

<script>
    let provider, signer, userAddress;
    // Адрес вашего контракта (впишем после создания)
    const contractAddress = "ВАШ_БУДУЩИЙ_АДРЕС_КОНТРАКТА"; 

    // Получаем реферала из URL
    const params = new URLSearchParams(window.location.search);
    let referrer = params.get('ref') || "0x0000000000000000000000000000000000000000";

    async function init() {
        if (referrer !== "0x0000000000000000000000000000000000000000") {
            document.getElementById('refAddr').innerText = referrer.substring(0,6) + "..." + referrer.substring(38);
        }

        // Подтягиваем курс BNB к USD через бесплатный API
        try {
            const response = await fetch('https://api.binance.com/api/v3/ticker/price?symbol=BNBUSDT');
            const data = await response.json();
            const bnbPrice = parseFloat(data.price);
            const bnbAmount = (10 / bnbPrice).toFixed(4);
            document.getElementById('bnbPriceDisplay').innerText = `~ ${bnbAmount} BNB`;
        } catch(e) { console.log("Ошибка курса"); }
    }

    async function connect() {
        if (window.ethereum) {
            provider = new ethers.providers.Web3Provider(window.ethereum);
            await provider.send("eth_requestAccounts", []);
            signer = provider.getSigner();
            userAddress = await signer.getAddress();
            
            document.getElementById('walletAddr').innerText = userAddress.substring(0,6) + "..." + userAddress.substring(38);
            document.getElementById('connectBtn').style.display = "none";
            document.getElementById('mainUI').style.display = "block";
            
            const link = window.location.origin + window.location.pathname + "?ref=" + userAddress;
            document.getElementById('refLinkDisplay').innerText = link;
            document.getElementById('refLinkDisplay').style.display = "block";
        } else {
            alert("Пожалуйста, откройте сайт в Trust Wallet или SafePal!");
        }
    }

    document.getElementById('connectBtn').onclick = connect;
    init();
</script>

</body>
</html>
